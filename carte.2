<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Concurrents Orange Bleue ‚Äì Carte interactive</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
:root {
  --orange: #ff6a00;
  --gris: #f4f4f4;
  --fonce: #333;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: var(--gris);
}

#topBar {
  position: fixed;
  top: 0;
  width: 100%;
  background: white;
  z-index: 1001;
  padding: 10px 15px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  display: flex;
  align-items: center;
  gap: 10px;
}

#search {
  flex: 1;
  padding: 8px;
  border: 2px solid var(--orange);
  border-radius: 5px;
}

#map {
  height: 100vh;
  width: 100%;
  margin-top: 55px;
}

#infoPanel {
  position: fixed;
  top: 55px;
  right: -100%;
  width: 45%;
  height: calc(100% - 55px);
  background: white;
  overflow-y: auto;
  box-shadow: -4px 0 10px rgba(0,0,0,0.25);
  transition: 0.4s;
  padding: 20px;
  z-index: 1000;
}

#infoPanel.active {
  right: 0;
}

.closeBtn {
  float: right;
  cursor: pointer;
  font-size: 22px;
}

h2 {
  color: var(--orange);
  margin-top: 0;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}

th, td {
  border: 1px solid #ddd;
  padding: 10px;
}

th {
  background: var(--orange);
  color: white;
}

.card {
  background: #fafafa;
  padding: 15px;
  border-radius: 8px;
}

/* Responsive */
@media (max-width: 768px) {
  #infoPanel {
    width: 100%;
    height: 50%;
    bottom: -100%;
    top: auto;
    right: 0;
  }

  #infoPanel.active {
    bottom: 0;
  }
}
</style>
</head>

<body>

<div id="topBar">
  <strong>üèãÔ∏è Concurrents Orange Bleue</strong>
  <input id="search" placeholder="Rechercher une salle‚Ä¶" oninput="filterGyms()">
</div>

<div id="map"></div>

<div id="infoPanel">
  <span class="closeBtn" onclick="closePanel()">‚ùå</span>
  <div id="panelContent"></div>
</div>

<script>
// ================= MAP =================
const map = L.map("map").setView([41.43, 2.18], 13);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "¬© OpenStreetMap"
}).addTo(map);

// ================= PANEL =================
const panel = document.getElementById("infoPanel");
const panelContent = document.getElementById("panelContent");

function openPanel(content, lat, lng) {
  panelContent.innerHTML = content;
  panel.classList.add("active");
  map.setView([lat, lng], 16);
}

function closePanel() {
  panel.classList.remove("active");
}

// ================= DATA =================
const gyms = [
{
  name: "Club Esports Fabra Gym",
  lat: 41.4335,
  lng: 2.1831,
  html: `
  <div class="card">
  <h2>üèãÔ∏è Club Esports Fabra Gym</h2>
  <table>
    <tr><th>Formule</th><th>Prix</th><th>Acc√®s</th><th>Remarques</th></tr>
    <tr><td>Mensuel</td><td>‚âà 50 ‚Ç¨</td><td>Muscu & fitness</td><td>Variable</td></tr>
    <tr><td>Annuel</td><td>‚ùì</td><td>Complet</td><td>Plus avantageux</td></tr>
  </table>
  </div>`
},

{
  name: "Nick Spa & Sport Club",
  lat: 41.4388,
  lng: 2.1864,
  html: `
  <div class="card">
  <h2>üíÜ Nick Spa & Sport Club</h2>
  <table>
    <tr><th>Formule</th><th>Prix</th><th>Acc√®s</th><th>Remarques</th></tr>
    <tr><td>Acc√®s limit√©</td><td>77,95 ‚Ç¨</td><td>Gym + spa</td><td>Horaires restreints</td></tr>
    <tr><td>Acc√®s libre</td><td>99,95 ‚Ç¨</td><td>Tout inclus</td><td>Premium</td></tr>
  </table>
  </div>`
}
];

// ================= MARKERS =================
const markers = [];

gyms.forEach(gym => {
  const marker = L.marker([gym.lat, gym.lng])
    .addTo(map)
    .bindPopup(gym.name)
    .on("click", () => openPanel(gym.html, gym.lat, gym.lng));
  markers.push(marker);
});

// ================= SEARCH =================
function filterGyms() {
  const q = document.getElementById("search").value.toLowerCase();
  markers.forEach((marker, i) => {
    if (gyms[i].name.toLowerCase().includes(q)) {
      marker.addTo(map);
    } else {
      map.removeLayer(marker);
    }
  });
}
</script>

</body>
</html>
